!function(a,c,d,e){var f=30,g=90,h=40,i=10,j=a.rad2deg=function(a){return a/(Math.PI/180)},k=(a.deg2rad=function(a){return a*(Math.PI/180)},navigator.platform.toLowerCase()),l=navigator.userAgent.toLowerCase(),m=(l.indexOf("iphone")>-1||l.indexOf("ipad")>-1)&&(k.indexOf("iphone")>-1||k.indexOf("ipad")>-1),n=a.Picker=function(a,b){var c=this;c.holder=a,c.options=b||{},c.init(),c.initInertiaParams(),c.calcElementItemPostion(!0),c.bindEvent()};n.prototype.findElementItems=function(){var a=this;return a.elementItems=[].slice.call(a.holder.querySelectorAll("li")),a.elementItems},n.prototype.init=function(){var a=this;a.list=a.holder.querySelector("ul"),a.findElementItems(),a.height=a.holder.offsetHeight,a.r=a.height/2-i,a.d=2*a.r,a.itemHeight=a.elementItems.length>0?a.elementItems[0].offsetHeight:h,a.itemAngle=parseInt(a.calcAngle(.8*a.itemHeight)),a.hightlightRange=a.itemAngle/2,a.visibleRange=g,a.beginAngle=0,a.beginExceed=a.beginAngle-f,a.list.angle=a.beginAngle,m&&(a.list.style.webkitTransformOrigin="center center "+a.r+"px")},n.prototype.calcElementItemPostion=function(a){var b=this;a&&(b.items=[]),b.elementItems.forEach(function(c){var d=b.elementItems.indexOf(c);if(b.endAngle=b.itemAngle*d,c.angle=b.endAngle,c.style.webkitTransformOrigin="center center -"+b.r+"px",c.style.webkitTransform="translateZ("+b.r+"px) rotateX("+-b.endAngle+"deg)",a){var e={};e.text=c.innerHTML||"",e.value=c.getAttribute("data-value")||e.text,b.items.push(e)}}),b.endExceed=b.endAngle+f,b.calcElementItemVisibility(b.beginAngle)},n.prototype.calcAngle=function(a){var c=this,d=b=parseFloat(c.r);a=Math.abs(a);var e=180*parseInt(a/c.d);a%=c.d;var f=(d*d+b*b-a*a)/(2*d*b),g=e+j(Math.acos(f));return g},n.prototype.calcElementItemVisibility=function(a){var b=this;b.elementItems.forEach(function(c){var d=Math.abs(c.angle-a);d<b.hightlightRange?c.classList.add("highlight"):d<b.visibleRange?(c.classList.add("visible"),c.classList.remove("highlight")):(c.classList.remove("highlight"),c.classList.remove("visible"))})},n.prototype.setAngle=function(a){var b=this;b.list.angle=a,b.list.style.webkitTransform="perspective(1000px) rotateY(0deg) rotateX("+a+"deg)",b.calcElementItemVisibility(a)},n.prototype.bindEvent=function(){var a=this,b=0,c=null;a.holder.addEventListener("touchstart",function(d){d.preventDefault(),a.list.style.webkitTransition="",c=(d.changedTouches?d.changedTouches[0]:d).pageY,b=a.list.angle,a.updateInertiaParams(d,!0)},!1),a.holder.addEventListener("touchend",function(b){b.preventDefault(),a.startInertiaScroll(b)},!1),a.holder.addEventListener("touchcancel",function(b){b.preventDefault(),a.startInertiaScroll(b)},!1),a.holder.addEventListener("touchmove",function(d){d.preventDefault();var e=(d.changedTouches?d.changedTouches[0]:d).pageY,f=e-c,g=a.calcAngle(f),h=f>0?b-g:b+g;h>a.endExceed&&(h=a.endExceed),h<a.beginExceed&&(h=a.beginExceed),a.setAngle(h),a.updateInertiaParams(d)},!1),a.list.addEventListener("tap",function(b){elementItem=b.target,"LI"==elementItem.tagName&&a.setSelectedIndex(a.elementItems.indexOf(elementItem),200)},!1)},n.prototype.initInertiaParams=function(){var a=this;a.lastMoveTime=0,a.lastMoveStart=0,a.stopInertiaMove=!1},n.prototype.updateInertiaParams=function(a,b){var c=this,d=a.changedTouches?a.changedTouches[0]:a;if(b)c.lastMoveStart=d.pageY,c.lastMoveTime=a.timeStamp||Date.now(),c.startAngle=c.list.angle;else{var e=a.timeStamp||Date.now();e-c.lastMoveTime>300&&(c.lastMoveTime=e,c.lastMoveStart=d.pageY)}c.stopInertiaMove=!0},n.prototype.startInertiaScroll=function(a){var b=this,c=a.changedTouches?a.changedTouches[0]:a,d=a.timeStamp||Date.now(),e=(c.pageY-b.lastMoveStart)/(d-b.lastMoveTime),f=e>0?-1:1,g=6e-4*f*-1,h=Math.abs(e/g),i=e*h/2,j=b.list.angle,k=b.calcAngle(i)*f,l=k;return j+k<b.beginExceed&&(k=b.beginExceed-j,h=h*(k/l)*.6),j+k>b.endExceed&&(k=b.endExceed-j,h=h*(k/l)*.6),0==k?void b.endScroll():void b.scrollDistAngle(d,j,k,h)},n.prototype.scrollDistAngle=function(a,b,c,d){var e=this;e.stopInertiaMove=!1,function(a,b,c,d){var f=13,g=d/f,h=0;!function i(){if(!e.stopInertiaMove){var a=e.quartEaseOut(h,b,c,g);return e.setAngle(a),h++,h>g-1||a<e.beginExceed||a>e.endExceed?void e.endScroll():void setTimeout(i,f)}}()}(a,b,c,d)},n.prototype.quartEaseOut=function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},n.prototype.endScroll=function(){var a=this;if(a.list.angle<a.beginAngle)a.list.style.webkitTransition="150ms ease-out",a.setAngle(a.beginAngle);else if(a.list.angle>a.endAngle)a.list.style.webkitTransition="150ms ease-out",a.setAngle(a.endAngle);else{var b=parseInt((a.list.angle/a.itemAngle).toFixed(0));a.list.style.webkitTransition="100ms ease-out",a.setAngle(a.itemAngle*b)}a.triggerChange()},n.prototype.triggerChange=function(b){var c=this;setTimeout(function(){var d=c.getSelectedIndex(),e=c.items[d];a.trigger&&(d!=c.lastIndex||b)&&a.trigger(c.holder,"change",{index:d,item:e}),c.lastIndex=d},0)},n.prototype.correctAngle=function(a){var b=this;return a<b.beginAngle?b.beginAngle:a>b.endAngle?b.endAngle:a},n.prototype.setItems=function(a){var b=this;b.items=a||[];var c=[];b.items.forEach(function(a){null!==a&&a!==e&&c.push("<li>"+(a.text||a)+"</li>")}),b.list.innerHTML=c.join(""),b.findElementItems(),b.calcElementItemPostion(),b.setAngle(b.correctAngle(b.list.angle)),b.triggerChange(!0)},n.prototype.getItems=function(){var a=this;return a.items},n.prototype.getSelectedIndex=function(){var a=this;return parseInt((a.list.angle/a.itemAngle).toFixed(0))},n.prototype.setSelectedIndex=function(a,b){var c=this;c.list.style.webkitTransition="";var d=c.correctAngle(c.itemAngle*a);if(b&&b>0){var e=d-c.list.angle;c.scrollDistAngle(Date.now(),c.list.angle,e,b)}else c.setAngle(d);c.triggerChange()},n.prototype.getSelectedItem=function(){var a=this;return a.items[a.getSelectedIndex()]},n.prototype.getSelectedValue=function(){var a=this;return(a.items[a.getSelectedIndex()]||{}).value},n.prototype.getSelectedText=function(){var a=this;return(a.items[a.getSelectedIndex()]||{}).text},n.prototype.setSelectedValue=function(a,b){var c=this;for(var d in c.items){var e=c.items[d];if(e.value==a)return void c.setSelectedIndex(d,b)}},a.fn&&(a.fn.picker=function(a){return this.each(function(b,c){if(!c.picker)if(a)c.picker=new n(c,a);else{var d=c.getAttribute("data-picker-options"),e=d?JSON.parse(d):{};c.picker=new n(c,e)}}),this[0]?this[0].picker:null},a.ready(function(){a(".mui-picker").picker()}))}(window.mui||window,window,document,void 0),function(a,b){a.dom=function(c){return"string"!=typeof c?c instanceof Array||c[0]&&c.length?[].slice.call(c):[c]:(a.__create_dom_div__||(a.__create_dom_div__=b.createElement("div")),a.__create_dom_div__.innerHTML=c,[].slice.call(a.__create_dom_div__.childNodes))};var c='<div class="mui-poppicker">		<div class="mui-poppicker-header">			<button class="mui-btn mui-poppicker-btn-cancel">取消</button>			<button class="mui-btn mui-btn-blue mui-poppicker-btn-ok">确定</button>			<div class="mui-poppicker-clear"></div>		</div>		<div class="mui-poppicker-body">		</div>	</div>',d='<div class="mui-picker">		<div class="mui-picker-inner">			<div class="mui-pciker-rule mui-pciker-rule-ft"></div>			<ul class="mui-pciker-list">			</ul>			<div class="mui-pciker-rule mui-pciker-rule-bg"></div>		</div>	</div>';a.PopPicker=a.Class.extend({init:function(d){var e=this;e.options=d||{},e.options.buttons=e.options.buttons||["取消","确定"],e.panel=a.dom(c)[0],b.body.appendChild(e.panel),e.ok=e.panel.querySelector(".mui-poppicker-btn-ok"),e.cancel=e.panel.querySelector(".mui-poppicker-btn-cancel"),e.body=e.panel.querySelector(".mui-poppicker-body"),e.mask=a.createMask(),e.cancel.innerText=e.options.buttons[0],e.ok.innerText=e.options.buttons[1],e.cancel.addEventListener("tap",function(a){e.hide()},!1),e.ok.addEventListener("tap",function(a){if(e.callback){var b=e.callback(e.getSelectedItems());b!==!1&&e.hide()}},!1),e.mask[0].addEventListener("tap",function(){e.hide(),e.disposed||e.dispose()},!1),e._createPicker(),e.panel.addEventListener("touchstart",function(a){a.preventDefault()},!1),e.panel.addEventListener("touchmove",function(a){a.preventDefault()},!1)},_createPicker:function(){var b=this,c=b.options.layer||1,e=100/c+"%";b.pickers=[];for(var f=1;c>=f;f++){var g=a.dom(d)[0];g.style.width=e,b.body.appendChild(g);var h=a(g).picker();b.pickers.push(h),g.addEventListener("change",function(a){var b=this.nextSibling;if(b&&b.picker){var c=a.detail||{},d=c.item||{};b.picker.setItems(d.children)}},!1)}},setData:function(a){var b=this;a=a||[],b.pickers[0].setItems(a)},getSelectedItems:function(){var a=this,b=[];for(var c in a.pickers){var d=a.pickers[c];b.push(d.getSelectedItem()||{})}return b},show:function(c){var d=this;d.callback=c,d.mask.show(),b.body.classList.add(a.className("poppicker-active-for-page")),d.panel.classList.add(a.className("active")),d.__back=a.back,a.back=function(){d.hide()}},hide:function(){var c=this;c.disposed||(c.panel.classList.remove(a.className("active")),c.mask.close(),b.body.classList.remove(a.className("poppicker-active-for-page")),a.back=c.__back)},dispose:function(){var a=this;a.hide(),setTimeout(function(){a.panel.parentNode.removeChild(a.panel);for(var b in a)a[b]=null,delete a[b];a.disposed=!0},300)}})}(mui,document),function(a,b){a.dom=function(c){return"string"!=typeof c?c instanceof Array||c[0]&&c.length?[].slice.call(c):[c]:(a.__create_dom_div__||(a.__create_dom_div__=b.createElement("div")),a.__create_dom_div__.innerHTML=c,[].slice.call(a.__create_dom_div__.childNodes))};var c='<div class="mui-dtpicker" data-type="datetime">		<div class="mui-dtpicker-header">			<button data-id="btn-cancel" class="mui-btn">取消</button>			<button data-id="btn-ok" class="mui-btn mui-btn-blue">确定</button>		</div>		<div class="mui-dtpicker-title"><h5 data-id="title-y">年</h5><h5 data-id="title-m">月</h5><h5 data-id="title-d">日</h5><h5 data-id="title-h">时</h5><h5 data-id="title-i">分</h5></div>		<div class="mui-dtpicker-body">			<div data-id="picker-y" class="mui-picker">				<div class="mui-picker-inner">					<div class="mui-pciker-rule mui-pciker-rule-ft"></div>					<ul class="mui-pciker-list">					</ul>					<div class="mui-pciker-rule mui-pciker-rule-bg"></div>				</div>			</div>			<div data-id="picker-m" class="mui-picker">				<div class="mui-picker-inner">					<div class="mui-pciker-rule mui-pciker-rule-ft"></div>					<ul class="mui-pciker-list">					</ul>					<div class="mui-pciker-rule mui-pciker-rule-bg"></div>				</div>			</div>			<div data-id="picker-d" class="mui-picker">				<div class="mui-picker-inner">					<div class="mui-pciker-rule mui-pciker-rule-ft"></div>					<ul class="mui-pciker-list">					</ul>					<div class="mui-pciker-rule mui-pciker-rule-bg"></div>				</div>			</div>			<div data-id="picker-h" class="mui-picker">				<div class="mui-picker-inner">					<div class="mui-pciker-rule mui-pciker-rule-ft"></div>					<ul class="mui-pciker-list">					</ul>					<div class="mui-pciker-rule mui-pciker-rule-bg"></div>				</div>			</div>			<div data-id="picker-i" class="mui-picker">				<div class="mui-picker-inner">					<div class="mui-pciker-rule mui-pciker-rule-ft"></div>					<ul class="mui-pciker-list">					</ul>					<div class="mui-pciker-rule mui-pciker-rule-bg"></div>				</div>			</div>		</div>	</div>';a.DtPicker=a.Class.extend({init:function(d){var e=this,f=a.dom(c)[0];b.body.appendChild(f),a('[data-id*="picker"]',f).picker();var g=e.ui={picker:f,mask:a.createMask(),ok:a('[data-id="btn-ok"]',f)[0],cancel:a('[data-id="btn-cancel"]',f)[0],y:a('[data-id="picker-y"]',f)[0],m:a('[data-id="picker-m"]',f)[0],d:a('[data-id="picker-d"]',f)[0],h:a('[data-id="picker-h"]',f)[0],i:a('[data-id="picker-i"]',f)[0],labels:a('[data-id*="title-"]',f)};g.cancel.addEventListener("tap",function(){e.hide(),e.disposed||e.dispose()},!1),g.ok.addEventListener("tap",function(){var a=e.callback(e.getSelected());a!==!1&&e.hide()},!1),g.y.addEventListener("change",function(){e._createDay()},!1),g.m.addEventListener("change",function(){e._createDay()},!1),g.mask[0].addEventListener("tap",function(){e.hide(),e.disposed||e.dispose()},!1),e._create(d),e.ui.picker.addEventListener("touchstart",function(a){a.preventDefault()},!1),e.ui.picker.addEventListener("touchmove",function(a){a.preventDefault()},!1)},getSelected:function(){var a=this,b=a.ui,c=a.options.type,d={type:c,y:b.y.picker.getSelectedItem(),m:b.m.picker.getSelectedItem(),d:b.d.picker.getSelectedItem(),h:b.h.picker.getSelectedItem(),i:b.i.picker.getSelectedItem(),toString:function(){return this.value}};switch(c){case"datetime":d.value=d.y.value+"-"+d.m.value+"-"+d.d.value+" "+d.h.value+":"+d.i.value,d.text=d.y.text+"-"+d.m.text+"-"+d.d.text+" "+d.h.text+":"+d.i.text;break;case"date":d.value=d.y.value+"-"+d.m.value+"-"+d.d.value,d.text=d.y.text+"-"+d.m.text+"-"+d.d.text;break;case"time":d.value=d.h.value+":"+d.i.value,d.text=d.h.text+":"+d.i.text;break;case"month":d.value=d.y.value+"-"+d.m.value,d.text=d.y.text+"-"+d.m.text;break;case"hour":d.value=d.y.value+"-"+d.m.value+"-"+d.d.value+" "+d.h.value,d.text=d.y.text+"-"+d.m.text+"-"+d.d.text+" "+d.h.text}return d},setSelectedValue:function(a){var b=this,c=b.ui,d=b._parseValue(a);c.y.picker.setSelectedValue(d.y,0),c.m.picker.setSelectedValue(d.m,0),c.d.picker.setSelectedValue(d.d,0),c.h.picker.setSelectedValue(d.h,0),c.i.picker.setSelectedValue(d.i,0)},isLeapYear:function(a){return a%4==0&&a%100!=0||a%400==0},_inArray:function(a,b){for(var c in a){var d=a[c];if(d===b)return!0}return!1},getDayNum:function(a,b){var c=this;return c._inArray([1,3,5,7,8,10,12],b)?31:c._inArray([4,6,9,11],b)?30:c.isLeapYear(a)?29:28},_fill:function(a){return a=a.toString(),a.length<2&&(a=0+a),a},_createYear:function(a){var b=this,c=b.options,d=b.ui,e=[];if(c.customData.y)e=c.customData.y;else for(var f=c.beginYear,g=c.endYear,h=f;g>=h;h++)e.push({text:h+"",value:h});d.y.picker.setItems(e)},_createMonth:function(a){var b=this,c=b.options,d=b.ui,e=[];if(c.customData.m)e=c.customData.m;else for(var f=1;12>=f;f++){var g=b._fill(f);e.push({text:g,value:g})}d.m.picker.setItems(e)},_createDay:function(a){var b=this,c=b.options,d=b.ui,e=[];if(c.customData.d)e=c.customData.d;else for(var f=b.getDayNum(parseInt(d.y.picker.getSelectedValue()),parseInt(d.m.picker.getSelectedValue())),g=1;f>=g;g++){var h=b._fill(g);e.push({text:h,value:h})}d.d.picker.setItems(e),a=a||d.d.picker.getSelectedValue()},_createHours:function(a){var b=this,c=b.options,d=b.ui,e=[];if(c.customData.h)e=c.customData.h;else for(var f=0;23>=f;f++){var g=b._fill(f);e.push({text:g,value:g})}d.h.picker.setItems(e)},_createMinutes:function(a){var b=this,c=b.options,d=b.ui,e=[];if(c.customData.i)e=c.customData.i;else for(var f=0;59>=f;f++){var g=b._fill(f);e.push({text:g,value:g})}d.i.picker.setItems(e)},_setLabels:function(){var a=this,b=a.options,c=a.ui;c.labels.each(function(a,c){c.innerText=b.labels[a]})},_setButtons:function(){var a=this,b=a.options,c=a.ui;c.cancel.innerText=b.buttons[0],c.ok.innerText=b.buttons[1]},_parseValue:function(a){var b={};if(a){var c=a.replace(":","-").replace(" ","-").split("-");b.y=c[0],b.m=c[1],b.d=c[2],b.h=c[3],b.i=c[4]}else{var d=new Date;b.y=d.getFullYear(),b.m=d.getMonth()+1,b.d=d.getDate(),b.h=d.getHours(),b.i=d.getMinutes()}return b},_create:function(a){var b=this;a=a||{},a.labels=a.labels||["年","月","日","时","分"],a.buttons=a.buttons||["取消","确定"],a.type=a.type||"datetime",a.customData=a.customData||{},b.options=a;var c=new Date;a.beginYear=a.beginYear||c.getFullYear()-5,a.endYear=a.endYear||c.getFullYear()+5;var d=b.ui;b._setLabels(),b._setButtons(),d.picker.setAttribute("data-type",a.type),b._createYear(),b._createMonth(),b._createDay(),b._createHours(),b._createMinutes(),b.setSelectedValue(a.value)},show:function(c){var d=this,e=d.ui;d.callback=c||a.noop,e.mask.show(),b.body.classList.add(a.className("dtpicker-active-for-page")),e.picker.classList.add(a.className("active")),d.__back=a.back,a.back=function(){d.hide()}},hide:function(){var c=this;if(!c.disposed){var d=c.ui;d.picker.classList.remove(a.className("active")),d.mask.close(),b.body.classList.remove(a.className("dtpicker-active-for-page")),a.back=c.__back}},dispose:function(){var a=this;a.hide(),setTimeout(function(){a.ui.picker.parentNode.removeChild(a.ui.picker);for(var b in a)a[b]=null,delete a[b];a.disposed=!0},300)}})}(mui,document);